1 GOTO9503
189 REM ***** MENU PRINCIPAL, AL LLEGAR AQUI SE RECALCULAN PRECIOS Y DESDE AQUI VAMOS A VIAJAR, COMPRAVENTA E INVENTARIO *****
190 CLS:DAY=DAY-1:PROFO=0:FORC=0TO7:C(C)=0:NEXTC:DEUDA=INT(DEUDA*1.03)
200 LOCATE 1,3:PRINT "V";VIDA
201 LOCATE 7,3:PRINT "D";DAY
202 LOCATE 11,3:PRINT USING"$ #########";DINERO
203 LOCATE 24,3:PRINT USING"% ######";DEUDA
209 X=12:Y=4:T$=B$(BA):GOSUB 9100:X=0:FORA=155to159:LOCATE X,0:PRINT CHR$(A):X=X+1:NEXTA:X=0:FORA=187to191:LOCATE X,1:PRINT CHR$(A):X=X+1:NEXTA
210 LOCATE 6,7:P=45:GOSUB 20000:E(0)=C: R=D(BA,0):GOSUB 20005:P(0)=M:P(0)=B(0)+P(0):PRINT D$(0);P(0)
220 LOCATE 6,8:P=35:GOSUB 20000:E(1)=C: R=D(BA,1):GOSUB 20005:P(1)=M:P(1)=B(1)+P(1):PRINT D$(1);P(1)
230 LOCATE 6,9:P=25:GOSUB 20000:E(2)=C: R=D(BA,2):GOSUB 20005:P(2)=M:P(2)=B(2)+P(2):PRINT D$(2);P(2)
240 LOCATE 6,10:P=20:GOSUB 20000:E(3)=C: R=D(BA,3):GOSUB 20005:P(3)=M:P(3)=B(3)+P(3):PRINT D$(3);P(3)
250 LOCATE 6,11:P=18:GOSUB 20000:E(4)=C: R=D(BA,4):GOSUB 20005:P(4)=M:P(4)=B(4)+P(4):PRINT D$(4);P(4)
260 LOCATE 6,12:P=16:GOSUB 20000:E(5)=C: R=D(BA,5):GOSUB 20005:P(5)=M:P(5)=B(5)+P(5):PRINT D$(5);P(5)
270 LOCATE 6,13:P=12:GOSUB 20000:E(6)=C: R=D(BA,6):GOSUB 20005:P(6)=M:P(6)=B(6)+P(6):PRINT D$(6);P(6)
280 LOCATE 6,14:P=10:GOSUB 20000:E(7)=C: R=D(BA,7):GOSUB 20005:P(7)=M:P(7)=B(7)+P(7):PRINT D$(7);P(7)
285 FOR B=0TO7:B(B)=0:NEXTB:V=USR2(0)
300 K$=INKEY$:IFK$<>""THENONINSTR("vViIcC",K$)GOTO405,405,505,505,605,605
305 GOTO300
310 CLS
311 X=12:Y=4:T$=B$(BA):GOSUB 9100
312 LOCATE 1,3:PRINT "V";VIDA
313 LOCATE 7,3:PRINT "D";DAY
314 LOCATE 11,3:PRINT USING"$ #########";DINERO
315 LOCATE 24,3:PRINT USING"% ######";DEUDA
316 LOCATE 6,7:PRINT D$(0);P(0)
320 LOCATE 6,8:PRINT D$(1);P(1)
330 LOCATE 6,9:PRINT D$(2);P(2)
340 LOCATE 6,10:PRINT D$(3);P(3)
350 LOCATE 6,11:PRINT D$(4);P(4)
360 LOCATE 6,12:PRINT D$(5);P(5)
370 LOCATE 6,13:PRINT D$(6);P(6)
380 LOCATE 6,14:PRINT D$(7);P(7)
381 V=USR2(0)
390 K$=INKEY$:IFK$<>""THENONINSTR("vViIcC",K$)GOTO405,405,505,505,605,605
395 GOTO390
400 REM ***** SELECCION DE BA PARA VIAJAR *****
405 :CLS:X=8:Y=1:T$="BARRIOS":GOSUB 9100:FORB=0TO6:LOCATE6,B+8:PRINT B$(B):NEXT
410 BA=0:V=USR2(0)
470 PUT SPRITE 0,(32,BA*8+64),8,0:FORT=0TO200:NEXT
471 ONSTICK(0)GOTO473,474,474,474,475:IFSTRIG(0)GOTO477ELSE471
473 BA=BA-1:IF BA<0THENBA=0
474 GOTO 470
475 BA=BA+1:IF BA>6THENBA=6
476 GOTO 470
477 IF BA=5 GOTO 701 ELSE IF BA=6 GOTO 801
482 FORT=0TO INT(RND(-TIME)*100):C=INT(RND(-TIME)*10):IF C>5 GOTO 483 ELSE 499
483 :CLS: PUT SPRITE 0,(0,0),0,0:PROFO=0:FORC=0TO7:C(C)=0:NEXTC
484 X=8:Y=8:T$="OCURRIO UN EVENTO":GOSUB 9100:V=USR2(0):FORT=0to1500:NEXTT
485 FORT=0TO INT(RND(-TIME)*100):R=INT(RND(1)*10)
486 IF R>7 GOTO487 ELSE IF R>5 GOTO 490 ELSE IF R=>0GOTO495
487 CLS:X=8:Y=8:T$="POLICIA!":GOSUB 9100:V=USR2(0):FORT=0to1500:NEXTT: GOTO 190
490 CLS:X=8:Y=8:T$="JONKIE!":GOSUB 9100:V=USR2(0):FORT=0to1500:NEXTT: GOTO 900
495 FORT=0TO INT(RND(-TIME)*100):U=INT(RND(1)*2):IF U=1THEN GOTO 496 ELSE 497
496 CLS:LOCATE 8,8: PRINT"REDADAS!": LOCATE 4,9: PRINT D$(R);"POR LAS NUBES!":R=INT(RND(1)*7):B(R)=INT(P(R)*3):GOTO 499
497 CLS:LOCATE 8,8: PRINT"OVERFLOW!": LOCATE 4,9: PRINT D$(R);"POR LOS SUELOS!":R=INT(RND(1)*7):B(R)=INT(P(R)*-0.4):GOTO 499
499 V=USR2(0):FORT=0to1500:NEXTT: GOTO 190
500 GOTO 190
501 REM ***** VISIONADO DE INVENTARIO Y DEUDA *****
505 :CLS:X=8:Y=1:T$="INVENTARIO":GOSUB 9100
510 FOR A=0TO8:INV=INV+I(A):NEXTA:MO=100-(MOCHILA-INV)
515 LOCATE 6,4:PRINT "MOCHILA:";MO"/100"
520 FOR A=0TO7
521 LOCATE 6,A+6:PRINT D$(A);I(A)
522 NEXT A
580 LOCATE 6,14:PRINT "MUNICION:   ";I(8)
585 V=USR2(0):INV=0:MO=100
590 K$=INKEY$:IFK$="m"ORK$="M" GOTO 310 ELSE 590
600 REM ***** COMPRA VENTA *****
605 CLS:X=8:Y=1:T$="TRAPICHEAR":GOSUB 9100
610 DROJA=0:P=45:GOSUB 20000:E(0)=C:P=35:GOSUB 20000:E(1)=C:P=25:GOSUB 20000:E(2)=C:P=20:GOSUB 20000:E(3)=C:P=18:GOSUB 20000:E(4)=C:P=16:GOSUB 20000:E(5)=C:P=12:GOSUB 20000:E(6)=C:P=10:GOSUB 20000:E(7)=C
611 LOCATE 14,5:PRINT "UNI."
612 LOCATE 20,5:PRINT "STOCK"
620 FOR A=0TO7
621 LOCATE 2,A+6:PRINT D$(A);E(A): LOCATE 21,A+6:PRINT I(A)
622 NEXT A
668 LOCATE 2,16:PRINT "PROFORMA:   ";PROFO
669 V=USR2(0)
670 PUT SPRITE 0,(5,DROJA*8 + 48),8,0:FORT=0TO200:NEXT
671 ONSTICK(0)GOTO674,671,676,671,681,671,683,671,:IF STRIG(0) GOTO 690
673 GOTO 671
674 DROJA=DROJA-1:IF DROJA<0THENDROJA=0
675 GOTO 670
676 IF E(DROJA)=0 THEN 671 ELSE 677
677 IF PROFO+P(DROJA)>DINERO THEN 671 ELSE 678
678 A=I(DROJA):I(DROJA)=(A+1):C(DROJA)=C(DROJA)+1:A=E(DROJA):E(DROJA)=(A-1): PROFO=(C(0)*P(0))+(C(1)*P(1))+(C(2)*P(2))+(C(3)*P(3))+(C(4)*P(4))+(C(5)*P(5))+(C(6)*P(6))+(C(7)*P(7)):P=PROFO-P(DROJA)
680 GOTO 620
690 DINERO=DINERO-PROFO:CLS:PUT SPRITE 0,(0,0),0,0: GOTO 310
681 DROJA=DROJA+1:IF DROJA>7THENDROJA=7
682 GOTO 670
683 IFI(DROJA)=0 THEN 670 ELSE 684
684 A=I(DROJA):I(DROJA)=(A-1):C(DROJA)=C(DROJA)-1:A=E(DROJA):E(DROJA)=(A+1): PROFO=(C(0)*P(0))+(C(1)*P(1))+(C(2)*P(2))+(C(3)*P(3))+(C(4)*P(4))+(C(5)*P(5))+(C(6)*P(6))+(C(7)*P(7))
685 GOTO 620
700 **** HOSPITAL ****
701 CLS: PUT SPRITE 0,(0,0),0,0:PROFO=0:FORC=0TO7:C(C)=0:NEXTC
705 X=8:Y=1:T$="HOSPITAL":GOSUB 9100
706 LOCATE 6,7:PRINT "VIDA +20   ";D(5,0)
707 LOCATE 6,8:PRINT "VIDA FULL  ";D(5,1)
710 HOSPI=0:V=USR2(0):X=32:Y=54
715 PUT SPRITE 0,(X,Y),8,0:FORT=0TO200:NEXT
716 LOCATE 6,11:PRINT VIDA
717 LOCATE 6,12:PRINT DINERO
720 K$=INKEY$:IFK$="m"ORK$="M" GOTO 405
721 ONSTICK(0)GOTO725,720,720,720,735:IFSTRIG(0)GOTO750ELSE720
725 Y=Y-8:IFY<54THENY=54:HOSPI=HOSPI-1:IF HOSPI<0THENHOSPI=0
730 GOTO 715
735 Y=Y+8:IFY>62THENY=62:HOSPI=HOSPI+1:IF HOSPI>1THENHOSPI=1
740 GOTO 715
750 FORT=0TO200:NEXTT:IF VIDA<100GOTO751 ELSE 715
751 ON HOSPI+1 GOTO 752,755
752 IF DINERO<100 GOTO 715 ELSE 753
753 VIDA=VIDA+20:DINERO=DINERO-100:IFVIDA>100THENVIDA=100
754 GOTO 715
755 IF DINERO<500 GOTO 715 ELSE 757
757 VIDA=VIDA+100:DINERO=DINERO-500:IFVIDA>100THENVIDA=100
758 GOTO 715
800 **** PRESTAMISTA ****
801 CLS: PUT SPRITE 0,(0,0),0,0:PRES=0:PROFO=0:FORC=0TO7:C(C)=0:NEXTC
805 X=8:Y=1:T$="PRESTAMISTA":GOSUB 9100
806 LOCATE 6,7:PRINT "DEUDA     ";DEUDA
807 LOCATE 6,8:PRINT "PISTOLA   ";D(6,0)
808 LOCATE 6,9:PRINT "GABARDINA ";D(6,1)
809 LOCATE 6,10:PRINT "GABARDINA+";D(6,2)
810 LOCATE 6,11:PRINT "MUNICION  ";D(6,3)
811 LOCATE 6,14:PRINT "DINERO    ";DINERO
814 V=USR2(0)
815 PUT SPRITE 0,(40,PRES*8 + 56),8,0:FORT=0TO200:NEXT
819 K$=INKEY$:IFK$="m"ORK$="M" GOTO 405
820 ONSTICK(0)GOTO825,820,831,820,836,820,820:IFSTRIG(0)GOTO850 ELSE 819
825 PRES=PRES-1:IF PRES<0THENPRES=0
830 GOTO 815
831 IF PRES<>0 GOTO 819
832 IF DINERO>DEUDA THEN 833 ELSE 819
833 IF DEUDA<100 THEN D=DEUDA:IF DEUDA>100 GOTO 834 ELSE GOTO 835
834 DINERO=DINERO-100:DEUDA=DEUDA-100:GOTO 806
835 DINERO=DINERO-D:DEUDA=0:D=0: GOTO 806
836 PRES=PRES+1:IF PRES>4THENPRES=4
840 GOTO 815
899 **** RUTINA DEL JONKIE ****
900 CLS: JO=0:LOCATE 8,8: PRINT"UN JONKIE TE ATACA": LOCATE 12,9: PRINT "QUE HACES?"
901 LOCATE 12,14: PRINT"ATACAR": LOCATE 12,15: PRINT"HUIR"
902 PUT SPRITE 0,(80,JO*8 + 112),8,0:FORT=0TO200:NEXT
903 K$=INKEY$:IFK$="m"ORK$="M" GOTO 405
904 ONSTICK(0)GOTO905,904,904,904,908,904,904:IFSTRIG(0)GOTO910 ELSE 903
905 JO=JO-1:IFJO<0THENJO=0:GOTO 902
908 JO=JO+1:IFJO>1THENJO=1:GOTO 902
910 IF JO=0GOTO920 ELSE 930
920 IF PI=1THEN GOTO 925 ELSE 921
921 FORT=0TO INT(RND(-TIME)*100):U=INT(RND(SEED)*2): IF U=0 GOTO 922 ELSE 925
922 LOCATE 2,17: PRINT"JONKIE TE PEGA UNA MOJADA":
923 FOR I=0TO7: IF MI>I(I) THEN MI=I(I): IF MA<I(I) THEN MA=I(I):MC=I:NEXT I
924 LOCATE 2,18: PRINT"VIDA -20 Y TE ROBA 3 DE";D$(R):VIDA=VIDA-20:I(MC)=I(MC)-3:FORT=0TO3500:NEXTT: GOTO 190
925 TIENES LA PIPA, MATALO
9099 REM ***** SUBRUTINA PRINT LETRAS GRANDES *****
9100 FORI=1TOLEN(T$):J=ASC(MID$(T$,I,1))
9101 IFJ<>32THENLOCATEX+I-1,Y:PRINTCHR$(J+64):LOCATEX+I-1,Y+1:PRINTCHR$(J+96)
9102 NEXT:RETURN
9502 REM ***** INICIAMOS PANTALLA, VARIABLES, ARRAY Y GRAFICOS *****
9503 DEFINTA-Z:SCREEN1:WIDTH32:KEYOFF:COLOR15,1,1:SCREEN2,0,0:BLOAD"GFX.BIN",S:POKE&HFCAF,1:KEY5,"run 9513"+CHR$(13):REM BLOAD"SFX.BIN",R
9504 IFINKEY$=""GOTO9504
9513 DEFUSR1=&H41:DEFUSR2=&H44:C=0:MI=0:MA=0:MC=0: BA=0: VIDA=30: DAY=31: MOCHILA=100: DINERO=3000: DEUDA=745:DIM D$(7),B$(6),D(6,7),E(7),I(8),P(7),C(7),B(7)
9516 RESTORE 10000:FOR B=0TO6:READ B$(B):FOR A=0TO7:READ D(B,A): NEXT A: NEXT B:RESTORE 10010:FOR B=0TO7:READ D$(B): NEXT B
9518 SEED=TIME:CLS
9530 GOTO 190
9999 REM **** PRECIOS POR BARRIO (X) Y DROJA (Y) ****
10000 DATA "LUTXANA",10,22,100,250,500,1000,2100,2500
10001 DATA "LA IBERIA",11,20,110,280,600,1050,2200,2400
10002 DATA "OTXARKOAGA",9,19,95,240,450,950,2000,2600
10003 DATA "BARRIKA",10,19,100,270,550,1150,2150,2550
10004 DATA "GALLUFA",9,21,105,230,480,1000,1950,2500
10005 DATA "HOSPITAL",11,500,30,220,480,2200,2300,2500
10006 DATA "PRESTAMISTA",1000,25,30,700,480,2200,2300,2500
10010 DATA "ANFETAMINA  ","HACHIS      ","MARIHUANA   ","COCAINA     ","MDMA        ","KRYPTONITA  ","CRISTAL     ","PEGAMENTO   "
19999 REM **** VARIABLE SEGUN PRECIO QUE USAMOS TAMBIEN PARA CANTIDAD DISPONIBLE (CUANTO MAS CARA MAS RARA)****
20000 FORT=0TO INT(RND(-TIME)*100):NEXTT:C=INT(RND(TIME)*P)
20001 RETURN
20004 REM **** P ES EL PORCENTAJE, U ES EL RANDOM PARA EL NEGATIVO Y M EL RESULTADO (SUMANDO O RESTANDO ALEATORIAMENTE) ****
20005 FORT=0TO INT(RND(-TIME)*100):NEXTT:P=(R/100)*C:U=INT(RND(1)*2):IF U=1THEN GOTO 20006 ELSE M=INT(P+R):RETURN
20006 M=INT(R-P)
20007 RETURN