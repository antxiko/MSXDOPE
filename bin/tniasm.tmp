bin.asm1256 DISSCR: equ $0041 7 ENASCR: equ $0044 8 LDIRVM: equ $005c 9 CLRSPR: equ $0069 10 INIGRP: equ $0072 1213 LINLEN: equ $f3b0 14 CLIKSW: equ $f3db 15 FORCLR: equ $f3e9 16 BAKCLR: equ $f3ea 17 BDRCLR: equ $f3eb 18 SCRMOD: equ $fcaf 2021 HKEYI: equ $fd9a 22 HTIMI: equ $fd9f 23 HOOK_SIZE: equ HTIMI - HKEYI2526 CHRTBL: equ $0000 27 NAMTBL: equ $1800 28 CLRTBL: equ $2000 29 SPRATR: equ $1B00 30 SPRTBL: equ $3800 3233 SCR_WIDTH: equ 3234 NAMTBL_SIZE: equ 32 * 2435 CHRTBL_SIZE: equ 256 * 836 SPRTBL_SIZE: equ 32 * 6437 SPAT_END: equ $d0 4042 db $fe 43 dw start_address44 dw end_address -145 dw execution_address4648 org $af0049start_address:50 5152execution_address:5455 ld a, 1556 ld [FORCLR], a57 ld a, 158 ld [BAKCLR], a59 ld [BDRCLR], a6061 call INIGRP62 call DISSCR6367 xor a68 ld [CLIKSW], a7071 ld hl, CHRTBL_PACKED72 call UNPACK73 ld de, CHRTBL74 call LDIRVM_CHRTBL_BANK75 ld de, CHRTBL + CHRTBL_SIZE76 call LDIRVM_CHRTBL_BANK77 ld de, CHRTBL + CHRTBL_SIZE + CHRTBL_SIZE78 call LDIRVM_CHRTBL_BANK8081 ld hl, CLRTBL_PACKED82 call UNPACK83 ld de, CLRTBL84 call LDIRVM_CLRTBL_BANK85 ld de, CLRTBL + CHRTBL_SIZE86 call LDIRVM_CLRTBL_BANK87 ld de, CLRTBL + CHRTBL_SIZE + CHRTBL_SIZE88 call LDIRVM_CLRTBL_BANK89 9091 ld hl, NAMTBL_PACKED92 call UNPACK93 ld de, NAMTBL94 ld bc, NAMTBL_SIZE95 call LDIRVM_UNPACKED96 9798 ld hl, SPRTBL_PACKED99 call UNPACK100 ld de, SPRTBL101 ld bc, SPRTBL_SIZE102 call LDIRVM_UNPACKED103 104105 call PLAYER_OFF106107 ld hl, wyzplayer_buffer.a108 ld [CANAL_A], hl109 ld hl, wyzplayer_buffer.b110 ld [CANAL_B], hl111 ld hl, wyzplayer_buffer.c112 ld [CANAL_C], hl113 ld hl, wyzplayer_buffer.p114 ld [CANAL_P], hl116117 ld hl, HTIMI118 ld de, htimi_hook_backup119 ld bc, HOOK_SIZE120 ldir121122 di123 ld hl, WYZPLAYER_HOOK124 ld de, HTIMI125 ld bc, HOOK_SIZE126 ldir127 ei129130 halt131 ld a, 0132 call CARGA_CANCION133 halt135136 call ENASCR138139 ld a, 1140 ld [SCRMOD], a141 ld a, SCR_WIDTH142 ld [LINLEN], a143 ret144146149LDIRVM_CHRTBL_BANK:150LDIRVM_CLRTBL_BANK:151 ld bc, CHRTBL_SIZE152 155159LDIRVM_UNPACKED:160 ld hl, unpack_buffer161 jp LDIRVM162164166WYZPLAYER_HOOK:167 push af 168 call INICIO169 pop af 170 jp htimi_hook_backup171173175 wyzplayer/WYZPROPLAY47cMSX.ASM157122023INICIO: CALL ROUT25 LD HL,PSG_REG26 LD DE,PSG_REG_SEC27 LD BC,1428 LDIR29 CALL REPRODUCE_SONIDO30 JP PLAY31 3638REPRODUCE_SONIDO:40 LD HL,INTERR41 BIT 2,[HL] 42 RET Z43 LD HL,[PUNTERO_SONIDO]44 LD A,[HL]45 CP $FF46 JR Z,FIN_SONIDO47 LD DE,[SFX_L]48 LD [DE],A49 INC HL50 LD A,[HL]51 RRCA52 RRCA53 RRCA54 RRCA55 AND 00001111B56 LD DE,[SFX_H]57 LD [DE],A58 LD A,[HL]59 AND 00001111B60 LD DE,[SFX_V]61 LD [DE],A63 INC HL64 LD A,[HL]65 LD B,A66 BIT 7,A 67 JR Z,NO_ENVOLVENTES_SONIDO68 LD A,$1269 LD [DE],A70 INC HL71 LD A,[HL]72 LD [PSG_REG_SEC+11],A73 INC HL74 LD A,[HL]75 LD [PSG_REG_SEC+12],A76 INC HL77 LD A,[HL]78 CP 179 JR Z,NO_ENVOLVENTES_SONIDO 80 LD [PSG_REG_SEC+13],A83NO_ENVOLVENTES_SONIDO:85 LD A,B86 and $7f 88 JR Z,NO_RUIDO89 LD [PSG_REG_SEC+6],A90 LD A,[SFX_MIX]91 JR SI_RUIDO92NO_RUIDO: XOR A93 LD [PSG_REG_SEC+6],A94 LD A,10111000B95SI_RUIDO: LD [PSG_REG_SEC+7],A97 INC HL98 LD [PUNTERO_SONIDO],HL99 RET100FIN_SONIDO: LD HL,INTERR101 RES 2,[HL]102 LD A,[ENVOLVENTE_BACK] 103 AND A104 JR Z,FIN_NOPLAYER105 106 LD [PSG_REG_SEC+13],A 108FIN_NOPLAYER: LD A,10111000B109 LD [PSG_REG_SEC+7],A111 RET115117ROUT: LD A,[PSG_REG+13]118 AND A 119 JR Z,NO_BACKUP_ENVOLVENTE120 LD [ENVOLVENTE_BACK],A 123 XOR A126NO_BACKUP_ENVOLVENTE:129 LD C,$A0130 LD HL,PSG_REG_SEC131LOUT: OUT [C],A132 INC C133 OUTI134 DEC C135 INC A136 CP 13137 JR NZ,LOUT138 OUT [C],A139 LD A,[HL]140 AND A141 RET Z142 INC C143 OUT [C],A144 XOR A145 LD [PSG_REG_SEC+13],A146 LD [PSG_REG+13],A147 RET150152INICIA_SONIDO: 155 LD HL,TABLA_SONIDOS156 CALL EXT_WORD157 LD [PUNTERO_SONIDO],DE158 LD HL,INTERR159 SET 2,[HL]160 RET161 162164PLAYER_INIT: LD HL,BUFFER_CANAL_A 165 LD [CANAL_A],HL 167 LD HL,BUFFER_CANAL_B168 LD [CANAL_B],HL170 LD HL,BUFFER_CANAL_C171 LD [CANAL_C],HL173 LD HL,BUFFER_CANAL_P174 LD [CANAL_P],HL176178PLAYER_OFF: XOR A 179 LD [INTERR],A180 182CLEAR_PSG_BUFFER:183 LD HL,PSG_REG184 LD DE,PSG_REG+1185 LD BC,14186 LD [HL],A187 LDIR189 LD A,10111000B 190 LD [PSG_REG+7],A192 LD HL,PSG_REG193 LD DE,PSG_REG_SEC194 LD BC,14195 LDIR197 JP ROUT200203CARGA_CANCION: LD HL,INTERR 205 SET 1,[HL] 206 LD HL,SONG207 LD [HL],A 211215217DECODE_SONG: LD A,[SONG]219222 LD HL,TABLA_SONG223 CALL EXT_WORD224 LD A,[DE]225 LD [TEMPO],A226 DEC A227 LD [TTEMPO],A229233 INC DE 234 LD A,[DE]235 BIT 0,A236 JR Z,NPTJP0237 LD HL,INTERR238 SET 4,[HL]242244NPTJP0: AND 00000110B245 RRA246 248 PUSH DE249 LD HL,TABLA_DATOS_CANAL_SFX250 CALL EXT_WORD251 PUSH DE252 POP IX253 LD E,[IX+0]254 LD D,[IX+1]255 LD [SFX_L],DE257 LD E,[IX+2]258 LD D,[IX+3]259 LD [SFX_H],DE261 LD E,[IX+4]262 LD D,[IX+5]263 LD [SFX_V],DE265 LD A,[IX+6]266 LD [SFX_MIX],A267 POP HL269 INC HL 270 INC HL271 INC HL273276 PUSH HL 277 POP IX279 LD DE,$0008 280 ADD HL,DE283 LD [PUNTERO_P_DECA],HL 284 LD E,[IX+0]285 LD D,[IX+1]286 ADD HL,DE287 LD [PUNTERO_L_DECA],HL 289 CALL BGICMODBC1290 LD [PUNTERO_P_DECB],HL291 LD E,[IX+2]292 LD D,[IX+3]293 ADD HL,DE294 LD [PUNTERO_L_DECB],HL296 CALL BGICMODBC1297 LD [PUNTERO_P_DECC],HL298 LD E,[IX+4]299 LD D,[IX+5]300 ADD HL,DE301 LD [PUNTERO_L_DECC],HL303 CALL BGICMODBC1304 LD [PUNTERO_P_DECP],HL305 LD E,[IX+6]306 LD D,[IX+7]307 ADD HL,DE308 LD [PUNTERO_L_DECP],HL311314INIT_DECODER: LD DE,[CANAL_A]315 LD [PUNTERO_A],DE316 LD HL,[PUNTERO_P_DECA]317 CALL DECODE_CANAL 318 LD [PUNTERO_DECA],HL320 LD DE,[CANAL_B]321 LD [PUNTERO_B],DE322 LD HL,[PUNTERO_P_DECB]323 CALL DECODE_CANAL 324 LD [PUNTERO_DECB],HL326 LD DE,[CANAL_C]327 LD [PUNTERO_C],DE328 LD HL,[PUNTERO_P_DECC]329 CALL DECODE_CANAL 330 LD [PUNTERO_DECC],HL332 LD DE,[CANAL_P]333 LD [PUNTERO_P],DE334 LD HL,[PUNTERO_P_DECP]335 CALL DECODE_CANAL 336 LD [PUNTERO_DECP],HL338 RET340342BGICMODBC1: LD E,$3F 343BGICMODBC2: XOR A 344 LD B,$FF 345 CPIR347 DEC HL348 DEC HL349 LD A,E 350 CP [HL]351 INC HL352 INC HL353 JR Z,BGICMODBC2355 DEC HL356 DEC HL357 DEC HL358 LD A,E 359 CP [HL]360 INC HL361 INC HL362 INC HL363 JR Z,BGICMODBC2364 RET366373DECODE_CANAL: LD A,[HL]374 AND A 375 JR Z,FIN_DEC_CANAL376 CALL GETLEN378 CP 00000001B 379 JR NZ,NO_SILENCIO380 or $40 381 JR NO_MODIFICA383NO_SILENCIO: CP 00111110B 384 JR NZ,NO_PUNTILLO385 OR A386 RRC B387 XOR A388 JR NO_MODIFICA390NO_PUNTILLO: CP 00111111B 391 JR NZ,NO_MODIFICA392 BIT 0,B 393 JR Z,NO_INSTRUMENTO394 LD A,11000001B 395 LD [DE],A396 INC HL397 INC DE398 ldi 402 ldi 406 JR DECODE_CANAL408NO_INSTRUMENTO: BIT 2,B409 JR Z,NO_ENVOLVENTE410 LD A,11000100B 411 LD [DE],A412 INC DE413 INC HL414 ldi 418 JR DECODE_CANAL420NO_ENVOLVENTE: BIT 1,B421 JR Z,NO_MODIFICA422 LD A,11000010B 423 LD [DE],A424 INC HL425 INC DE426 LD A,[HL]427 CALL GETLEN429NO_MODIFICA: LD [DE],A430 INC DE431 XOR A432 DJNZ NO_MODIFICA433 or $81 435 LD [DE],A436 INC DE437 INC HL438 RET 440FIN_DEC_CANAL: or $80 441 LD [DE],A442 INC DE443 RET445GETLEN: LD B,A446 AND 00111111B447 PUSH AF448 LD A,B449 AND 11000000B450 RLCA451 RLCA452 INC A453 LD B,A454 LD A,10000000B455DCBC0: RLCA456 DJNZ DCBC0457 LD B,A458 POP AF459 RET465468PLAY: LD HL,INTERR 469 BIT 1,[HL]470 RET Z471472 LD HL,TTEMPO 473 INC [HL]474 LD A,[TEMPO]475 CP [HL]476 JR NZ,PAUTAS477 LD [HL],0479480 LD IY,PSG_REG481 LD IX,PUNTERO_A482 LD BC,PSG_REG+8483 CALL LOCALIZA_NOTA484 LD IY,PSG_REG+2485 LD IX,PUNTERO_B486 LD BC,PSG_REG+9487 CALL LOCALIZA_NOTA488 LD IY,PSG_REG+4489 LD IX,PUNTERO_C490 LD BC,PSG_REG+10491 CALL LOCALIZA_NOTA492 LD IX,PUNTERO_P 493 CALL LOCALIZA_EFECTO495497PAUTAS: LD IY,PSG_REG+0498 LD IX,PUNTERO_P_A499 LD HL,PSG_REG+8500 CALL PAUTA 501 LD IY,PSG_REG+2502 LD IX,PUNTERO_P_B503 LD HL,PSG_REG+9504 CALL PAUTA 505 LD IY,PSG_REG+4506 LD IX,PUNTERO_P_C507 LD HL,PSG_REG+10508 JP PAUTA 514517520LOCALIZA_NOTA: LD L,[IX+PUNTERO_A-PUNTERO_A] 521 LD H,[IX+PUNTERO_A-PUNTERO_A+1]522 LD A,[HL]523 AND 11000000B 524 CP 11000000B525 JR NZ,LNJP0527529COMANDOS: LD A,[HL]530 BIT 0,A 531 JR Z,COM_EFECTO533 INC HL534 LD A,[HL] 535 INC HL536 LD E,[HL]538 PUSH HL 539 LD HL,TEMPO540 BIT 5,E541 JR Z,NO_DEC_TEMPO542 DEC [HL]543NO_DEC_TEMPO: BIT 6,E544 JR Z,NO_INC_TEMPO545 INC [HL]546NO_INC_TEMPO: RES 5,E 547 RES 6,E548 POP HL550 LD [IX+VOL_INST_A-PUNTERO_A],E 551 INC HL552 LD [IX+PUNTERO_A-PUNTERO_A],L553 LD [IX+PUNTERO_A-PUNTERO_A+1],H554 LD HL,TABLA_PAUTAS555 CALL EXT_WORD556 LD [IX+PUNTERO_P_A0-PUNTERO_A],E557 LD [IX+PUNTERO_P_A0-PUNTERO_A+1],D558 LD [IX+PUNTERO_P_A-PUNTERO_A],E559 LD [IX+PUNTERO_P_A-PUNTERO_A+1],D560 LD L,C561 LD H,B562 RES 4,[HL] 563 XOR A564 LD [PSG_REG_SEC+13],A565 LD [PSG_REG+13],A566 567 JR LOCALIZA_NOTA569COM_EFECTO: BIT 1,A 570 JR Z,COM_ENVOLVENTE572 INC HL573 LD A,[HL]574 INC HL575 LD [IX+PUNTERO_A-PUNTERO_A],L576 LD [IX+PUNTERO_A-PUNTERO_A+1],H577 JP INICIA_SONIDO579COM_ENVOLVENTE: BIT 2,A580 RET Z 582 INC HL583 LD A,[HL] 584 LD [ENVOLVENTE],A585 INC HL586 LD [IX+PUNTERO_A-PUNTERO_A],L587 LD [IX+PUNTERO_A-PUNTERO_A+1],H588 LD L,C589 LD H,B590 LD [HL],00010000B 591 JR LOCALIZA_NOTA594LNJP0: LD A,[HL]595 INC HL596 BIT 7,A597 JR Z,NO_FIN_CANAL_A 598 BIT 0,A599 JR Z,FIN_CANAL_A601FIN_NOTA_A: LD E,[IX+CANAL_A-PUNTERO_A]602 LD D,[IX+CANAL_A-PUNTERO_A+1] 603 LD [IX+PUNTERO_A-PUNTERO_A],E604 LD [IX+PUNTERO_A-PUNTERO_A+1],D605 LD L,[IX+PUNTERO_DECA-PUNTERO_A] 606 LD H,[IX+PUNTERO_DECA-PUNTERO_A+1]607 PUSH BC608 CALL DECODE_CANAL 609 POP BC610 LD [IX+PUNTERO_DECA-PUNTERO_A],L 611 LD [IX+PUNTERO_DECA-PUNTERO_A+1],H612 JP LOCALIZA_NOTA614FIN_CANAL_A: LD HL,INTERR 615 BIT 4,[HL]616 JR NZ,FCA_CONT617 POP AF618 JP PLAYER_OFF621FCA_CONT: LD L,[IX+PUNTERO_L_DECA-PUNTERO_A] 622 LD H,[IX+PUNTERO_L_DECA-PUNTERO_A+1]623 LD [IX+PUNTERO_DECA-PUNTERO_A],L624 LD [IX+PUNTERO_DECA-PUNTERO_A+1],H625 JR FIN_NOTA_A627NO_FIN_CANAL_A: LD [IX+PUNTERO_A-PUNTERO_A],L 628 LD [IX+PUNTERO_A-PUNTERO_A+1],H629 AND A 630 JR Z,FIN_RUTINA631 BIT 6,A 632 JR Z,NO_SILENCIO_A633 LD A,[BC]634 AND 00010000B635 JR NZ,SILENCIO_ENVOLVENTE637 XOR A638 LD [BC],A 639 LD [IY+0],A640 LD [IY+1],A641 RET643SILENCIO_ENVOLVENTE:644 LD A,$FF645 LD [PSG_REG+11],A646 LD [PSG_REG+12],A647 XOR A648 LD [PSG_REG+13],A649 LD [IY+0],A650 LD [IY+1],A651 RET653NO_SILENCIO_A: LD [IX+REG_NOTA_A-PUNTERO_A],A 654 CALL NOTA 655 LD L,[IX+PUNTERO_P_A0-PUNTERO_A] 656 LD H,[IX+PUNTERO_P_A0-PUNTERO_A+1]657 LD [IX+PUNTERO_P_A-PUNTERO_A],L 658 LD [IX+PUNTERO_P_A-PUNTERO_A+1],H659FIN_RUTINA: RET662665LOCALIZA_EFECTO:LD L,[IX+0] 666 LD H,[IX+1]667 LD A,[HL]668 CP 11000010B669 JR NZ,LEJP0671 INC HL672 LD A,[HL]673 INC HL674 LD [IX+00],L675 LD [IX+01],H676 JP INICIA_SONIDO679LEJP0: INC HL680 BIT 7,A681 JR Z,NO_FIN_CANAL_P 682 BIT 0,A683 JR Z,FIN_CANAL_P684FIN_NOTA_P: LD DE,[CANAL_P]685 LD [IX+0],E686 LD [IX+1],D687 LD HL,[PUNTERO_DECP] 688 PUSH BC689 CALL DECODE_CANAL 690 POP BC691 LD [PUNTERO_DECP],HL 692 JP LOCALIZA_EFECTO694FIN_CANAL_P: LD HL,[PUNTERO_L_DECP] 695 LD [PUNTERO_DECP],HL696 JR FIN_NOTA_P698NO_FIN_CANAL_P: LD [IX+0],L 699 LD [IX+1],H700 RET702707711PAUTA: BIT 4,[HL] 712 RET NZ714 LD A,[IY+0]715 LD B,[IY+1]716 OR B717 RET Z720 PUSH HL722PCAJP4: LD L,[IX+0]723 LD H,[IX+1]724 LD A,[HL]726 BIT 7,A 727 JR Z,PCAJP0728 AND 00011111B 729 RLCA 730 LD D,0731 LD E,A732 SBC HL,DE733 LD A,[HL]735PCAJP0: BIT 6,A 736 JR Z,PCAJP1737 LD E,[IY+0]738 LD D,[IY+1]740 AND A741 RRC D742 RR E743 LD [IY+0],E744 LD [IY+1],D745 JR PCAJP2747PCAJP1: BIT 5,A 748 JR Z,PCAJP2749 LD E,[IY+0]750 LD D,[IY+1]752 AND A753 RLC E754 RL D755 LD [IY+0],E756 LD [IY+1],D761PCAJP2: LD A,[HL]762 BIT 4,A763 JR NZ,PCAJP6 765 INC HL 766 PUSH HL767 LD E,A768 LD A,[HL] 769 LD L,A770 AND A771 LD A,E772 JR Z,ORNMJP1774 LD A,[IY+0] 775 ADD A,[IY+1]776 AND A777 LD A,E778 JR Z,ORNMJP1781 BIT 7,L782 JR Z,ORNNEG783 LD H,$FF784 JR PCAJP3785ORNNEG: LD H,0787PCAJP3: LD E,[IY+0]788 LD D,[IY+1]789 ADC HL,DE790 LD [IY+0],L791 LD [IY+1],H792 JR ORNMJP1795PCAJP6: INC HL 797 PUSH HL798 PUSH AF799 LD A,[IX+REG_NOTA_A-PUNTERO_P_A] 800 LD E,[HL] 801 ADC E 802 CALL TABLA_NOTAS803 POP AF806ORNMJP1: POP HL808 INC HL809 LD [IX+0],L810 LD [IX+1],H811PCAJP5: POP HL812 LD B,[IX+VOL_INST_A-PUNTERO_P_A] 813 ADD B814 JP P,PCAJP7815 LD A,1 816PCAJP7: AND 00001111B 817 LD [HL],A818 RET822827NOTA: LD L,C828 LD H,B829 BIT 4,[HL]830 LD B,A831 JR NZ,EVOLVENTES832 LD A,B833TABLA_NOTAS: LD HL,DATOS_NOTAS 834 CALL EXT_WORD835 LD [IY+0],E836 LD [IY+1],D837 RET842845EVOLVENTES: LD HL,DATOS_NOTAS846 847 RLCA 848 LD D,0849 LD E,A850 ADD HL,DE851 LD E,[HL]852 INC HL853 LD D,[HL]855 PUSH DE856 LD A,[ENVOLVENTE] 857 RRA858 JR NC,FRECUENCIA_OFF859 LD [IY+0],E860 LD [IY+1],D861 JR CONT_ENV863FRECUENCIA_OFF: LD DE,$0000864 LD [IY+0],E865 LD [IY+1],D866 867CONT_ENV: POP DE868 PUSH AF869 PUSH BC870 AND 00000011B871 LD B,A872 874 875 RR D876 RR E877CRTBC0: 878 RR D879 RR E880 DJNZ CRTBC0881 LD A,E882 LD [PSG_REG+11],A883 LD A,D884 AND 00000011B885 LD [PSG_REG+12],A886 POP BC887 POP AF 889 RRA890 AND 00000110B 891 ADD 8892 LD [PSG_REG+13],A893 LD [ENVOLVENTE_BACK],A894 RET897902EXT_WORD: LD D,0903 RLCA904 LD E,A905 ADD HL,DE906 LD E,[HL]907 INC HL908 LD D,[HL]909 RET911913TABLA_DATOS_CANAL_SFX:915 DW SELECT_CANAL_A,SELECT_CANAL_B,SELECT_CANAL_C918923SELECT_CANAL_A: DW PSG_REG_SEC+0,PSG_REG_SEC+1,PSG_REG_SEC+8924 DB 10110001B926SELECT_CANAL_B: DW PSG_REG_SEC+2,PSG_REG_SEC+3,PSG_REG_SEC+9927 DB 10101010B929SELECT_CANAL_C: DW PSG_REG_SEC+4,PSG_REG_SEC+5,PSG_REG_SEC+10930 DB 10011100B931bin.asm176178UNPACK:179 ld de, unpack_buffer180 zx7/dzx7_standard.tniasm.asm110dzx7_standard:11 ld a, $8012dzx7s_copy_byte_loop:13 ldi 14dzx7s_main_loop:15 call dzx7s_next_bit16 jr nc, dzx7s_copy_byte_loop 1819 push de20 ld bc, 021 ld d, b22dzx7s_len_size_loop:23 inc d24 call dzx7s_next_bit25 jr nc, dzx7s_len_size_loop2728dzx7s_len_value_loop:29 call nc, dzx7s_next_bit30 rl c31 rl b32 jr c, dzx7s_exit 33 dec d34 jr nz, dzx7s_len_value_loop35 inc bc 3738 ld e, (hl) 39 inc hl40 db $cb, $33 41 jr nc, dzx7s_offset_end 42 ld d, $10 43dzx7s_rld_next_bit:44 call dzx7s_next_bit45 rl d 46 jr nc, dzx7s_rld_next_bit 47 inc d 48 srl d 49dzx7s_offset_end:50 rr e 5253 ex (sp), hl 54 push hl 55 sbc hl, de 56 pop de 57 ldir58dzx7s_exit:59 pop hl 60 jr nc, dzx7s_main_loop61dzx7s_next_bit:62 add a, a 63 ret nz 64 ld a, (hl) 65 inc hl66 rla67 ret6970bin.asm181183185CHRTBL_PACKED:186 incbin "charset.pcx.chr.zx7"187CLRTBL_PACKED:188 incbin "charset.pcx.clr.zx7"189 190191NAMTBL_PACKED:192 incbin "screen.tmx.bin.zx7"193 194195SPRTBL_PACKED:196 incbin "sprites.pcx.spr.zx7"198199 DonusTrak.mus.asm123TABLA_PAUTAS: DW PAUTA_0,PAUTA_1,PAUTA_2,PAUTA_3,PAUTA_4,PAUTA_5,PAUTA_6,PAUTA_7,PAUTA_856TABLA_SONIDOS: DW SONIDO0,SONIDO1,SONIDO2,SONIDO3810PAUTA_0: DB 46,0,13,0,12,0,11,0,1291112PAUTA_1: DB 8,0,74,0,11,0,43,0,10,0,72,0,8,0,40,0,8,0,1321314PAUTA_2: DB 4,0,71,0,8,0,40,0,8,0,70,0,5,0,37,0,5,0,69,0,1321516PAUTA_3: DB 72,0,10,0,11,0,12,0,11,0,10,0,9,0,8,0,1291718PAUTA_4: DB 69,0,6,0,7,0,7,0,5,0,5,0,1291920PAUTA_5: DB 5,0,70,0,6,0,37,0,4,0,3,0,1292122PAUTA_6: DB 43,0,12,0,12,0,12,0,12,0,11,0,11,0,11,0,11,0,10,0,10,0,10,0,10,0,11,0,11,0,11,0,11,0,1442324PAUTA_7: DB 78,0,44,0,10,0,8,0,7,0,1292526PAUTA_8: DB 75,0,41,0,8,0,7,0,6,0,1292830SONIDO0: DB 209,63,0,209,78,0,69,109,0,2553132SONIDO1: DB 69,47,0,232,44,5,0,57,2,2553334SONIDO2: DB 0,11,1,0,6,1,2553536SONIDO3: DB 186,58,0,0,102,0,162,131,0,2553839DATOS_NOTAS: DW 0,040DW 1711,1614,1524,1438,1358,1281,1210,1142,1078,101741DW 960,906,855,807,762,719,679,641,605,57142DW 539,509,480,453,428,404,381,360,339,32043DW 302,285,269,254,240,227,214,202,190,18044DW 170,160,151,143,135,127,120,113,107,10145DW 95,90,85,80,76,71,67,64,60,5746bin.asm200TABLA_SONG:201 dw $ + 2202 incbin "DonusTrak.mus"203204 205end_address:207208 org $e000209 210211unpack_buffer:212 214215htimi_hook_backup:216 rb HOOK_SIZE218219 wyzplayer/WYZPROPLAY47c_RAM.tniasm.ASM157912INTERR: rb 1 1923SONG: rb 1 24TEMPO: rb 1 25TTEMPO: rb 1 26 27PUNTERO_A: rw 1 28PUNTERO_B: rw 1 29PUNTERO_C: rw 1 30 31CANAL_A: rw 1 32CANAL_B: rw 1 33CANAL_C: rw 1 34 35PUNTERO_P_A: rw 1 36PUNTERO_P_B: rw 1 37PUNTERO_P_C: rw 1 38 39PUNTERO_P_A0: rw 1 40PUNTERO_P_B0: rw 1 41PUNTERO_P_C0: rw 1 42 43PUNTERO_P_DECA: rw 1 44PUNTERO_P_DECB: rw 1 45PUNTERO_P_DECC: rw 1 46 47PUNTERO_DECA: rw 1 48PUNTERO_DECB: rw 1 49PUNTERO_DECC: rw 1 51REG_NOTA_A: rb 1 52VOL_INST_A: rb 1 53REG_NOTA_B: rb 1 54VOL_INST_B: rb 1 55REG_NOTA_C: rb 1 56VOL_INST_C: rb 1 57 58PUNTERO_L_DECA: rw 1 59PUNTERO_L_DECB: rw 1 60PUNTERO_L_DECC: rw 1 6264PUNTERO_P: rw 1 65CANAL_P: rw 1 66PUNTERO_P_DECP: rw 1 67PUNTERO_DECP: rw 1 68PUNTERO_L_DECP: rw 1 72SFX_L: rw 1 73SFX_H: rw 1 74SFX_V: rw 1 75SFX_MIX: rw 1 7880N_SONIDO: rb 1 81PUNTERO_SONIDO: rw 1 8587PSG_REG: rb 1688PSG_REG_SEC: rb 1689ENVOLVENTE: rb 1 93ENVOLVENTE_BACK: rb 1 9699BUFFER_CANAL_A: rb $10100BUFFER_CANAL_B: rb $10101BUFFER_CANAL_C: rb $10102BUFFER_CANAL_P: rb $10103bin.asm221222wyzplayer_buffer:223.a: rb $20224.b: rb $20225.c: rb $20226.p: rb $20228229